<!DOCTYPE HTML>
<html>
<head>
  <script src="//js.leapmotion.com/leap-0.6.2.js"></script>
  <script src="//js.leapmotion.com/leap-plugins-0.1.7.js"></script>
  <script src="./leap.click-event.js"></script>

  <script src="../../utils/data-plotter/LeapDataPlotter.js"></script>
  <style>
    .leap-data-plotter {
      position: absolute;
      top: 80px;
      right: 0;
    }
  </style>

</head>
<body onload="onload();">

<p>
  This experimental plugin measures finger angle and emits "click" events.
</p>
<!--
<a href="#">Demo Proximal Down/Up</a>
<a href="#">Demo Thumb-Click</a>
-->

<p>
  There are three possible click states:
</p>
<ul>
  <li>Proximal</li>
  <li>Medial</li>
  <li>Curl</li>
</ul>
<p>
  Each of these fire events when measured values cross a threshold.  These values are also available:
</p>
<ul>
  <li>proximalCurl</li>
  <li>medialCurl</li>
  <li>fingerCurl</li>
</ul>
<p>
  See graph demonstration.
</p>

<div id="output"></div>

<script type="text/javascript">

  var fingerTypeNames = ['thumb', 'indexFinger', 'middleFinger', 'ringFinger', 'pinky'];

  var output = document.getElementById('output');
  var prepend = function(str){
    output.innerHTML =  '<br/>' + str + output.innerHTML;
  }

  var logEvent = function(eventName){
    Leap.loopController.on(eventName, function(finger){
      prepend( fingerTypeNames[finger.type] + eventName )
    })
  }


  window.onload = function(){
    window.plotter = new LeapDataPlotter
  };

  Leap.loop(function(frame){
    var hand = frame.hands[0];
    if (!hand) return;
    if (!window.plotter) return;

    plotter.plot('indexFingerProximalCurl', hand.indexFinger.proximalCurl, {
      precision: 3,
      pointColor: hand.indexFinger.data('proximalDown') ? '#d00' : '#300'
    });

    plotter.plot('indexFingerMedialCurl', hand.indexFinger.medialCurl, {
      precision: 3,
      pointColor: hand.indexFinger.data('medialDown') ? '#0d0' : '#030'
    });

    plotter.update();

  }).use('clickEvents');

  logEvent('proximalDown');
  logEvent('proximalNeutral');
  logEvent('proximalUp');
  logEvent('medialDown');
  logEvent('medialNeutral');



</script>

</body>
</html>