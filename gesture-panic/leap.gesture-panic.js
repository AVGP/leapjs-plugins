// Generated by CoffeeScript 1.6.3
(function() {
  Leap.Controller.plugin('panic', function() {
    var pitchDeltas;
    pitchDeltas = [];
    return {
      hand: function(hand) {
        var currentPitch, delta, lastPitch, now, sum, timeWindow, _i, _len;
        if (hand.timeVisible < 1) {
          return;
        }
        lastPitch = hand.data('panic.lastPitch');
        currentPitch = hand.pitch();
        hand.data('panic.lastPitch', currentPitch);
        if (!lastPitch) {
          return;
        }
        now = new Date();
        pitchDeltas.push({
          delta: currentPitch - lastPitch,
          time: now
        });
        timeWindow = now.setSeconds(now.getSeconds() - 1);
        while (pitchDeltas[0].time < timeWindow) {
          pitchDeltas.shift();
        }
        sum = 0;
        for (_i = 0, _len = pitchDeltas.length; _i < _len; _i++) {
          delta = pitchDeltas[_i];
          sum += Math.abs(delta.delta);
        }
        if (sum > 0.3) {
          pitchDeltas = [];
          return hand.panicing = true;
        }
      }
    };
  });

}).call(this);
